# BeachStat2
http://beachstat.herokuapp.com/

## История

Приложение было написано мной в августе 2013 года для подсчёта и online-отображения рейтинга текущего пляжного сезона.
В 2012 году было более простое приложение, представляющее собой статические web-странички, генерируемые неким скриптом с использованием SQL-запросов к sqlite БД.

Проект использвоался в качестве учебного.
Как раз в то время я проходил курс Saas I (Software as a Service part I) на edX.org. Курс, кстати, очень полезный.
Так что в качестве основных исчтоников информации по программированию на Rails для меня выступали
- SaasI
- Rails Tutorial. 

Сейчас для того, чтобы освежить основные сведения по Rails я могу посмотреть
- Свои конспекты SaaS I в PIM dokuwiki
- Свои записи по Rails Cheatshett в PIM dokuwiki
- Rails Tutorial.

## Текущее состояние (Июль 2015)
- Окружение для работы у меня на вирутальной машине SaaSBook на ноутбуке MSI
- Актуальный код на github
- Вполне рабочее (но минималистичное) Rails-приложение со всей статистикой 2013 года
- До сих пор работающее приложение на Heroku!
- Работающее преложение в Контакте (Vk.com) - SpajicBeach (просто iFrame, который загружает странички с Heroku)

## Запуск и использование приложения локально
- cd BeachStat2
- rails server
- в Браузере октрыть 0.0.0.0:3000/main/main

## Workflow по внесению изменений
- git pull
- Внести изменения
- git commit
- git push
- git push heroku master - в результате обновлённое приложение деплоится на heroku и изменения можно увидеть в vk


## Внесение данных об игровом дне
- В файле seeds.rb код ruby, который заново наполняет всю БД
- Надо в него внести обновления, закомиттить, запушить и выполнить
- rake db:seed (локально)
- heroku run rake db:seed

## BDD (Behavior Driven Design)
В курсе SaaS учили BDD с использованием Cucumber и Capybara.
- Cucumber - инструмент для написания user stories на DSL и их использования как Acceptance tests и Integration tests
- Capybara - инструмент для автоматических выполнений действий в браузере (нажимать кнопки, ходить по ссылкам и пр)

- Тесты Cucumber хранятся в папке Features. У меня в этом проекте сейчас таких тестов нет.
- Для запуска тестов используется команда cucumber.

## TDD (Test Driven Design)
В SaaS учили, что инструемнт для TDD - RSpec (DSL for testing).
Ещё есть классные инструменты guard, spork.
По-моему, в этом проекте я до них не добрался.
А вот в учебном проекте SaaS I всё настроил: в итоге получается очень круто:
- вносишь какие-нибудь изменения, сохраняешь файл
- guard определяет событие изменения файла, запускает необходимые тесты
  - guard-rspec
  - по guard и guard-rspec есть rails-cast: http://railscasts.com/episodes/264-guard
  - по rspec есть rails-cast
  - по guard minitest есть информация в rails tutorial
  - Если guard не замечает каких-то изменений, надо доработать Guardfile, где сопоставлены изменения в файлах и соответствующие действия
- spork используется guard для запуска тестов в отдельных окружениях
- growl - всплывающие уведомления для Ubuntu, через которые guard выводит результаты выполнения тестов


Для того, чтобы всем этим пользоваться надо выполнить в отдельном терминале команду guard - в результате он запустится, и будет ждать изменения файлов. При внесении изменений он будет запускать необходимые тесты и выводить результаты через уведомление growl.

Отдельно тесты rspec можно запустить командой rspec.

Сейчас у меня в этом проекте есть ряд тестов rspec (в папке spec), в основном для Player - модели игрока, включая расчёт статистики.

Ещё есть разные полезные gem'ы для поддержки ТТВ, например, FactoryGirl для генерации fixtures.

Насчёт fixtures у меня есть несколько .yml файлов с тестовыми данными в spec/fixures.

## TDD workflow
  - запустить guard в отдельном терминале
  - Рабоать TDD. Все изменения как в тестах, так и в коде должны автоматически проверяться guard, а уведломления с результатами выводиться через growl.
  - Отдельно можно запустить тесты через команды rspec, cucumber.

## Планы развития
Пожелания по развитию собираются в github issues.

RoadMap примерно такой:
- Заменить данные об играх на данные 2015 года
- Сообщить ребятам, что статистика снова в деле
- Регулярно пополнять данные об игровых днях (лучше всего день-в-день)
- Прикрутить bootstrap, чтобы дизайн выглядел по-солиднее
- Аналогично этому проекту освежить в памяти и привести в порядок проект по статистике 2012 года
- Сделать табличку с рейтингом сортируемой и симпатичной (как было в 2012)
- Сделать графики рейтинга игроков в зависимости от времени (как было в 2012)
- Сделать систему аутентификации, чтобы можно было зайти с правами администратора
- Сделать web-интерфейс для ввода результатов игрового дня (доступно для администратора)
- Сделать возможность на основе тех или иных алгоритмов (в частности, Machine Learning) делать расчёт вероятности победы пары в предстоящем матче
- Сделать приложение на Qt для работы со статистикой (первоначально: просмотр результатов, добавление игрового дня и игр в него)
- Опубликовать приложение на Qt в Appstore и Google Play
- Возможность просмотра результатов за разные годы
- Отчёт по легинонерам, призовому фонду
- Ввод результатов за 2012 год
- Ввод результатов за 2014 год (я старался всё записывать, хотя руки до приложения в 2014 году так и не дошли)
- Сделать персональные странички игроков
- Красивое оформление 
- Галерея фото
- Галерея видео
